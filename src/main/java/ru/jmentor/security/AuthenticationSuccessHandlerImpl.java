package ru.jmentor.security;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.Authentication;import org.springframework.security.core.authority.AuthorityUtils;import org.springframework.security.web.authentication.AuthenticationSuccessHandler;import org.springframework.stereotype.Component;import ru.jmentor.model.User;import ru.jmentor.service.UserService;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import java.io.IOException;import java.util.Set;@Componentpublic class AuthenticationSuccessHandlerImpl implements AuthenticationSuccessHandler {    private UserService service;    @Autowired    public void setService(UserService service) {        this.service = service;    }    public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException {        Set<String> roles = AuthorityUtils.authorityListToSet(authentication.getAuthorities());        HttpSession session = request.getSession();        User user = (User) authentication.getPrincipal();        session.setAttribute("name", user.getUserName());        String role = "USER";                if (service.getByName(user.getUserName()).getRole().toString().contains("admin")) { role = "ADMIN"; }        session.setAttribute("role", role);        if (roles.contains("ROLE_admin")) { response.sendRedirect("/admin"); }        else { response.sendRedirect("/userHome"); }    }}